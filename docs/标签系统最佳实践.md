# Lumina 标签系统改进方案

基于 Flomo 最佳实践的研究分析

## 1. 核心设计原则

### 1.1 标签哲学
- **分类是生长出来的，而非规划出来的**
- 标签用于"索引"和"连接"，而非简单的分类
- 整理只是路径，真正的目的在于在某个领域持续精进

### 1.2 标签类型区分
- **导航类标签**：频繁访问的主标签（如 #营销、#设计）
- **内容线索标签**：起补充说明作用（如 #营销管理、#零售的哲学）

## 2. 多级标签系统

### 2.1 格式规范
```
#标签/子标签/孙标签
```

### 2.2 示例
```
#技术/前端/React
#读书/不同/营销近视症
#生活/旅行/杭州
```

### 2.3 实现要点
- 支持任意层级深度
- 搜索时自动匹配相关标签
- 显示时用面包屑或缩进表示层级

## 3. P.A.I.R 分类法

### 3.1 定义
| 类型 | 说明 | 示例 |
|------|------|------|
| **Project（项目）** | 需要多个动作完成的独立事件 | 写一本书、组织旅游 |
| **Area（领域）** | 日常需要精进的领域（最重要） | 健康、写作、编程 |
| **Inbox（收件箱）** | 临时缓存，定期归档 | 待消化的知识点 |
| **Resource（资源）** | 感兴趣的内容或未来材料 | 读书笔记、人物案例 |

### 3.2 置顶标签策略
- 最多 5 个置顶标签，建议 3 个
- 置顶标签用于主导航
- 示例：#Inbox, #Area, #Project, #Books, #People

## 4. UI/UX 设计要求

### 4.1 卡片底部标签显示
```
┌─────────────────────────────────────┐
│           笔记内容区域               │
│                                     │
├─────────────────────────────────────┤
│ #技术/React         +2    14:30  💬 │
└─────────────────────────────────────┘
```

### 4.2 设计规范
- 标签与内容分离，不在正文中高亮
- 主标签显示完整路径，子标签用 `+N` 表示
- 使用彩色药丸样式（8色调色板）
- 点击标签跳转到筛选视图

### 4.3 标签输入体验
- 输入 `#` 自动触发标签建议
- 支持多级标签输入（使用 `/` 分隔）
- 显示已有标签列表供选择
- 支持创建新标签

## 5. 标签管理界面

### 5.1 标签浏览器
- 树状结构显示所有标签
- 显示每个标签的笔记数量
- 支持折叠/展开子标签
- 点击标签筛选相关笔记

### 5.2 置顶标签设置
- 拖拽排序置顶标签
- 最多设置 5 个
- 在侧边栏快速访问

## 6. 实现优先级

### P0 - 核心功能
1. 卡片底部标签显示（已完成）
2. 标签点击筛选功能（已完成）
3. 多级标签支持（已有）

### P1 - 用户体验增强
1. 标签自动补全
2. 标签浏览器界面
3. 置顶标签管理

### P2 - 高级功能
1. 标签重命名/合并
2. 标签统计面板
3. 标签导入/导出

## 7. 技术实现要点

### 7.1 标签提取（已有）
```typescript
// server/routerTrpc/note/noteUtils.ts
const hashtagRegex = /(?<![:\/])#[\u4e00-\u9fa5a-zA-Z0-9_\/]+(?=[*?.。、,，;；:!！??:？:\s#]|$)/g;
```

### 7.2 标签颜色映射（已有）
```typescript
// app/src/lib/helpers/tagColorHelper.ts
export function getTagColorInfo(tagName: string): TagColorInfo
```

### 7.3 需要新增
1. **标签自动补全组件**
   - 监听编辑器 `#` 输入
   - 查询匹配的标签列表
   - 显示下拉选择器

2. **标签浏览器组件**
   - 读取所有标签
   - 构建树状结构
   - 显示笔记数量统计

3. **置顶标签管理**
   - 用户配置存储
   - 侧边栏快速访问
   - 拖拽排序

## 8. 参考资源

- [Flomo 多级标签使用指南](https://help.flomoapp.com/method/use-tag.html)
- [Flomo P.A.I.R 方法](https://help.flomoapp.com/thinking/iarp.html)
- [如何进行标签管理](https://help.flomoapp.com/community/user-story/manage-tags.html)
